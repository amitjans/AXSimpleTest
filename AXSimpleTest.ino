//Includes
#include <Servo.h>

//Defines
#define PAN_PIN 10        //Pan Servo Digital Pin
#define TILT_PIN 11       //Tilt Servo Digital Pin

#define H_JOY_PIN 0       //Horizontal Joystick Analog Pin
#define V_JOY_PIN 1       //Vertical Joystick Analog Pin

#define LASER_PIN 2       //Laser Digital Pin

#define PUSHBUTTON_PIN 4  //Pushbutton Digital Pin

//deadband values for the joysticks - values between DEADBANDLOW and DEADBANDHIGH will be ignored
#define DEADBANDLOW 480   //lower deadband value for the joysticks  
#define DEADBANDHIGH 540  //upper deadband value for the joysticks  

//max/min puse values in microseconds to send to the servo
#define PAN_MIN      600  //full counterclockwise for RobotGeek 180 degree servo
#define PAN_MAX      2400 //full clockwise for RobotGeek 180 degree servo
#define TILT_MIN  600     //full counterclockwise for RobotGeek 180 degree servo
#define TILT_MAX  2400    //full clockwise for RobotGeek 180 degree servo
#define SIZE_EMO  300
#define SIZE_EMO2  100
int speed = 40;        //alter this value to change the speed of the system. Higher values mean higher speeds 5-500 approximate recommended range

char ordenMovimiento = 0;

Servo panServo, tiltServo;  // create servo objects to control the pan and tilt servos

int horizontalValue, verticalValue;            //variables to hold the last reading from the analog pins for the horizontal and vertical joystick
int horizontalValueMapped, verticalValueMapped;//variables to hold mapped readings from the vertical values. These mapped readings will be appropriate to work with servo values

int panValue = 1500;   //current positional value being sent to the pan servo.
int tiltValue = 1500;  //current positional value being sent to the tilt servo.

//State Variables
int laserState = LOW;         //The current state of the laser module
int buttonState;             // the current state of the pushbuton
int lastButtonState = LOW;   // the previous reading from the input pin

//Timing variables for button debouncing
long lastDebounceTime = 0;  // the last time the output pin was toggled. This variable is a 'long' because it may need to hold many milliseconds, and a 'long' will afford more space than an 'int'
int debounceDelay = 50;    // the amount of time that that a button must be held, for a reading to register (in milliseconds)

//int panTristeza [SIZE_EMO];
//int tiltTristeza [SIZE_EMO];
int index = 0;
int panBefore = 0;
int tiltBefore = 0;


//Tristeza 1
//int panTristeza [SIZE_EMO] = {1500,1500,1500,1500,1500,1500,1500,1500,1500,1500,1500,1500,1500,1500,1500,1500,1500,1500,1500,1500,1500,1500,1500,1500,1500,1500,1500,1500,1500,1500,1500,1500,1500,1500,1500,1500,1500,1500,1500,1496,1489,1480,1469,1457,1444,1430,1416,1402,1388,1374,1360,1346,1332,1318,1304,1290,1276,1262,1248,1234,1220,1206,1192,1178,1164,1150,1136,1122,1108,1094,1080,1068,1058,1052,1056,1060,1066,1073,1080,1087,1095,1105,1116,1128,1140,1152,1164,1176,1189,1201,1214,1227,1240,1253,1266,1279,1292,1305,1318,1331,1344,1357,1370,1383,1396,1409,1422,1434,1447,1460,1473,1485,1496,1505,1511,1515,1519,1521,1523,1528,1535,1543,1551,1559,1567,1575,1583,1591,1599,1607,1615,1623,1631,1639,1647,1651,1655,1659,1663,1667,1671,1675,1679,1683,1687,1691,1695,1699,1703,1707,1711,1715,1719,1723,1727,1731,1735,1738,1734,1730,1725,1720,1715,1709,1703,1696,1688,1679,1670,1661,1652,1642,1632,1622,1611,1600,1589,1578,1567,1556,1545,1534,1523,1512,1501,1490,1479,1468,1457,1446,1435,1424,1413,1402,1391,1380,1369,1358,1347,1336,1326,1316,1316,1316,1316,1316,1316,1316,1316,1316,1316,1316,1316,1316,1318,1320,1322,1324,1326,1328,1330,1332,1334,1336,1338,1340,1342,1344,1346,1348,1350,1352,1354,1356,1358,1360,1362,1364,1366,1368,1370,1372,1374,1376,1378,1380,1382,1384,1386,1388,1390,1392,1394,1396,1399,1402,1405,1408,1412,1415,1418,1421,1424,1427,1430,1433,1436,1439,1442,1445,1448,1451,1454,1457,1460,1463,1466,1469,1472,1475,1478,1481,1484,1487,1490,1493,1496,1499,1502,1505,1508,1511,1514,1517,1520,1523,1526,1529,1532,1500};
//int tiltTristeza [SIZE_EMO]= {1500,1496,1491,1485,1479,1473,1466,1459,1452,1444,1436,1427,1418,1408,1398,1388,1378,1368,1358,1348,1337,1326,1315,1304,1293,1282,1271,1260,1249,1238,1227,1216,1205,1194,1183,1173,1165,1158,1154,1154,1154,1154,1154,1154,1154,1154,1154,1154,1154,1154,1154,1154,1154,1154,1154,1154,1154,1154,1154,1154,1154,1154,1154,1154,1154,1154,1154,1154,1154,1154,1154,1154,1154,1154,1154,1154,1154,1154,1154,1154,1154,1154,1154,1154,1154,1154,1154,1154,1154,1154,1154,1154,1154,1154,1154,1154,1154,1154,1154,1154,1154,1154,1154,1154,1154,1154,1154,1154,1154,1154,1154,1154,1154,1154,1154,1154,1154,1154,1154,1154,1154,1154,1154,1154,1154,1154,1154,1154,1154,1154,1154,1154,1154,1154,1154,1154,1154,1154,1154,1154,1154,1154,1154,1154,1154,1154,1154,1154,1154,1154,1154,1154,1154,1154,1154,1154,1154,1154,1154,1154,1154,1154,1154,1154,1154,1154,1154,1154,1154,1154,1154,1154,1154,1154,1154,1154,1154,1154,1154,1154,1154,1154,1154,1154,1154,1156,1159,1162,1165,1169,1175,1182,1189,1197,1206,1215,1225,1235,1245,1255,1264,1270,1273,1278,1284,1291,1298,1306,1315,1324,1334,1345,1356,1367,1378,1389,1400,1411,1422,1431,1439,1442,1442,1442,1442,1442,1442,1442,1442,1442,1442,1442,1442,1442,1442,1442,1442,1442,1442,1442,1442,1442,1442,1442,1442,1442,1442,1442,1442,1442,1442,1442,1442,1442,1442,1442,1442,1442,1442,1442,1442,1442,1442,1442,1442,1442,1442,1442,1442,1442,1442,1442,1442,1442,1442,1442,1442,1442,1442,1442,1442,1442,1442,1442,1442,1442,1442,1442,1442,1442,1442,1442,1442,1442,1442,1442,1442,1442,1442,1500};

char panTristeza [SIZE_EMO] = {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,-4,-7,-9,-11,-12,-13,-14,-14,-14,-14,-14,-14,-14,-14,-14,-14,-14,-14,-14,-14,-14,-14,-14,-14,-14,-14,-14,-14,-14,-14,-14,-14,-12,-10,-6,4,4,6,7,7,7,8,10,11,12,12,12,12,12,13,12,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,12,13,13,13,12,11,9,6,4,4,2,2,5,7,8,8,8,8,8,8,8,8,8,8,8,8,8,8,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,3,-4,-4,-5,-5,-5,-6,-6,-7,-8,-9,-9,-9,-9,-10,-10,-10,-11,-11,-11,-11,-11,-11,-11,-11,-11,-11,-11,-11,-11,-11,-11,-11,-11,-11,-11,-11,-11,-11,-11,-11,-11,-11,-10,-10,0,0,0,0,0,0,0,0,0,0,0,0,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,3,3,3,3,4,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,-32};
char tiltTristeza [SIZE_EMO] = {0,-4,-5,-6,-6,-6,-7,-7,-7,-8,-8,-9,-9,-10,-10,-10,-10,-10,-10,-10,-11,-11,-11,-11,-11,-11,-11,-11,-11,-11,-11,-11,-11,-11,-11,-10,-8,-7,-4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,3,3,4,6,7,7,8,9,9,10,10,10,10,9,6,3,5,6,7,7,8,9,9,10,11,11,11,11,11,11,11,11,9,8,3,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,58};


//Tristeza 2
//int panTristeza [SIZE_EMO] = {1500,1500,1500,1500,1500,1500,1500,1500,1500,1500,1500,1500,1500,1500,1500,1500,1500,1500,1500,1500,1500,1500,1500,1500,1500,1500,1500,1500,1500,1500,1500,1500,1500,1500,1500,1500,1500,1500,1500,1500,1500,1500,1500,1500,1500,1500,1500,1497,1493,1489,1485,1481,1477,1472,1467,1462,1457,1452,1447,1441,1435,1428,1421,1414,1407,1400,1393,1386,1379,1372,1365,1358,1351,1344,1337,1330,1323,1316,1309,1302,1295,1288,1281,1274,1267,1260,1253,1246,1239,1234,1236,1238,1241,1244,1247,1250,1254,1258,1262,1266,1270,1275,1280,1285,1291,1297,1303,1310,1317,1324,1331,1338,1345,1352,1359,1366,1373,1380,1387,1394,1401,1408,1415,1422,1429,1436,1443,1450,1457,1464,1471,1478,1485,1492,1499,1506,1512,1518,1524,1530,1535,1540,1545,1550,1554,1558,1562,1566,1570,1574,1578,1582,1586,1590,1594,1598,1602,1606,1610,1614,1618,1622,1626,1630,1634,1638,1641,1644,1647,1650,1652,1654,1656,1658,1660,1656,1652,1648,1644,1640,1636,1632,1628,1623,1618,1613,1608,1603,1598,1592,1586,1580,1574,1567,1560,1553,1546,1539,1532,1525,1518,1511,1504,1497,1490,1483,1476,1469,1462,1455,1448,1441,1434,1427,1421,1421,1421,1421,1421,1421,1421,1421,1421,1421,1421,1421,1421,1421,1421,1421,1421,1421,1421,1421,1421,1421,1421,1421,1421,1421,1421,1421,1421,1421,1421,1421,1421,1421,1421,1421,1421,1421,1421,1421,1421,1421,1421,1421,1421,1421,1421,1421,1421,1421,1421,1421,1421,1421,1421,1421,1421,1421,1421,1421,1421,1421,1421,1421,1421,1421,1421,1421,1421,1421,1421,1421,1421,1421,1421,1421,1421,1421,1430,1440,1450,1460,1470,1480,1490,1500};
//int tiltTristeza [SIZE_EMO]= {1500,1497,1494,1491,1488,1485,1481,1477,1473,1469,1465,1460,1455,1449,1443,1437,1431,1424,1417,1410,1403,1396,1389,1382,1375,1368,1361,1354,1347,1340,1333,1326,1319,1312,1305,1298,1291,1284,1277,1270,1263,1256,1249,1243,1237,1231,1226,1226,1226,1226,1226,1226,1226,1226,1226,1226,1226,1226,1226,1226,1226,1226,1226,1226,1226,1226,1226,1226,1226,1226,1226,1226,1226,1226,1226,1226,1226,1226,1226,1226,1226,1226,1226,1226,1226,1226,1226,1226,1226,1226,1226,1226,1226,1226,1226,1226,1226,1226,1226,1226,1226,1226,1226,1226,1226,1226,1226,1226,1226,1226,1226,1226,1226,1226,1226,1226,1226,1226,1226,1226,1226,1226,1226,1226,1226,1226,1226,1226,1226,1226,1226,1226,1226,1226,1226,1226,1226,1226,1226,1226,1226,1226,1226,1226,1226,1226,1226,1226,1226,1226,1226,1226,1226,1226,1226,1226,1226,1226,1226,1226,1226,1226,1226,1226,1226,1226,1226,1226,1226,1226,1226,1226,1226,1226,1226,1226,1226,1226,1226,1226,1226,1226,1226,1226,1226,1226,1226,1226,1226,1226,1226,1226,1226,1226,1226,1226,1226,1226,1226,1226,1226,1226,1226,1226,1226,1226,1226,1226,1226,1226,1226,1226,1226,1226,1226,1228,1231,1234,1237,1241,1245,1249,1253,1258,1263,1268,1273,1278,1284,1290,1296,1302,1308,1314,1320,1326,1332,1339,1346,1353,1360,1367,1374,1381,1388,1395,1402,1409,1416,1423,1430,1437,1443,1449,1454,1458,1462,1466,1469,1471,1473,1476,1479,1482,1485,1488,1491,1494,1498,1503,1508,1513,1518,1523,1528,1533,1537,1539,1536,1533,1530,1527,1524,1520,1515,1510,1505,1500,1495,1490,1485,1480,1475,1470,1464,1458,1452,1465,1480,1500};
//char panTristeza [SIZE_EMO] = {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,-3,-4,-4,-4,-4,-4,-5,-5,-5,-5,-5,-5,-6,-6,-7,-7,-7,-7,-7,-7,-7,-7,-7,-7,-7,-7,-7,-7,-7,-7,-7,-7,-7,-7,-7,-7,-7,-7,-7,-7,-7,-7,-5,2,2,3,3,3,3,4,4,4,4,4,5,5,5,6,6,6,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,6,6,6,6,5,5,5,5,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,3,3,3,3,2,2,2,2,2,-4,-4,-4,-4,-4,-4,-4,-4,-5,-5,-5,-5,-5,-5,-6,-6,-6,-6,-7,-7,-7,-7,-7,-7,-7,-7,-7,-7,-7,-7,-7,-7,-7,-7,-7,-7,-7,-7,-7,-6,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,9,10,10,10,10,10,10,10};
//char tiltTristeza [SIZE_EMO]= {0,-3,-3,-3,-3,-3,-4,-4,-4,-4,-4,-5,-5,-6,-6,-6,-6,-7,-7,-7,-7,-7,-7,-7,-7,-7,-7,-7,-7,-7,-7,-7,-7,-7,-7,-7,-7,-7,-7,-7,-7,-7,-7,-6,-6,-6,-5,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,3,3,4,4,4,4,5,5,5,5,5,6,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,6,6,5,4,4,4,3,2,2,3,3,3,3,3,3,3,4,5,5,5,5,5,5,5,4,2,-3,-3,-3,-3,-3,-4,-5,-5,-5,-5,-5,-5,-5,-5,-5,-5,-6,-6,-6,13,15,20};

//Pensar
//int panPensar[SIZE_EMO] = {1500,1497,1494,1490,1486,1482,1478,1473,1468,1462,1456,1450,1444,1437,1430,1423,1415,1407,1399,1391,1382,1373,1364,1355,1346,1337,1328,1319,1310,1301,1292,1283,1274,1265,1256,1247,1238,1229,1220,1211,1202,1193,1184,1175,1166,1166,1166,1166,1166,1166,1166,1166,1166,1166,1166,1166,1166,1166,1166,1166,1166,1166,1166,1166,1166,1166,1166,1166,1166,1166,1168,1171,1174,1177,1181,1185,1190,1195,1201,1207,1214,1221,1228,1235,1242,1250,1258,1266,1275,1284,1293,1302,1311,1320,1329,1338,1346,1354,1362,1370,1378,1386,1394,1402,1410,1418,1422,1426,1430,1434,1438,1442,1446,1450,1454,1458,1462,1466,1470,1474,1478,1482,1486,1490,1494,1498,1502,1506,1510,1514,1518,1522,1526,1530,1534,1538,1542,1546,1550,1554,1558,1562,1566,1570,1574,1578,1582,1586,1590,1594,1598,1602,1606,1610,1614,1618,1622,1626,1630,1634,1638,1642,1646,1650,1654,1658,1662,1666,1670,1674,1678,1682,1686,1690,1694,1698,1702,1706,1710,1714,1718,1722,1726,1730,1734,1738,1742,1746,1750,1754,1758,1762,1766,1770,1774,1778,1782,1786,1790,1794,1798,1802,1806,1810,1814,1818,1822,1826,1830,1834,1838,1842,1846,1850,1854,1858,1862,1866,1870,1874,1878,1882,1886,1890,1894,1898,1902,1906,1910,1914,1918,1922,1926,1929,1925,1920,1915,1909,1903,1896,1889,1882,1875,1868,1860,1852,1844,1836,1828,1820,1812,1804,1796,1788,1780,1772,1764,1756,1748,1740,1732,1724,1716,1708,1700,1692,1684,1676,1668,1660,1652,1644,1636,1628,1620,1612,1604,1596,1588,1580,1572,1564,1556,1548,1540,1532,1528,1523,1517,1510,1503,1495,1487,1479,1471,1463,1471,1480,1490,1500};
//int tiltPensar[SIZE_EMO] = {1500,1500,1500,1500,1500,1500,1500,1500,1500,1500,1500,1500,1500,1500,1500,1500,1500,1500,1500,1500,1500,1500,1500,1500,1500,1500,1500,1500,1500,1500,1500,1500,1500,1500,1500,1500,1500,1500,1500,1500,1500,1500,1500,1500,1500,1502,1505,1508,1511,1514,1518,1523,1528,1534,1540,1546,1552,1558,1564,1570,1576,1582,1588,1594,1600,1606,1612,1618,1623,1626,1626,1626,1626,1626,1626,1626,1626,1626,1626,1626,1626,1626,1626,1626,1626,1626,1626,1626,1626,1626,1626,1626,1626,1626,1626,1626,1626,1626,1626,1626,1626,1626,1626,1626,1626,1626,1626,1626,1626,1626,1626,1626,1626,1626,1626,1626,1626,1626,1626,1626,1626,1626,1626,1626,1626,1626,1626,1626,1626,1626,1626,1626,1626,1626,1626,1626,1626,1626,1626,1626,1626,1626,1626,1626,1626,1626,1626,1626,1626,1626,1626,1626,1626,1626,1626,1626,1626,1626,1626,1626,1626,1626,1626,1626,1626,1626,1626,1626,1626,1626,1626,1626,1626,1626,1626,1626,1626,1626,1626,1626,1626,1626,1626,1626,1626,1623,1618,1613,1607,1601,1595,1588,1581,1574,1567,1560,1552,1544,1535,1526,1517,1508,1499,1490,1481,1473,1465,1457,1450,1443,1437,1432,1428,1428,1428,1428,1428,1428,1428,1428,1428,1428,1428,1428,1428,1428,1428,1428,1428,1428,1428,1428,1428,1428,1428,1428,1428,1428,1428,1428,1428,1428,1428,1428,1428,1428,1428,1428,1428,1428,1428,1428,1428,1428,1428,1428,1428,1428,1428,1428,1428,1428,1428,1428,1428,1428,1428,1428,1428,1428,1428,1428,1428,1428,1428,1428,1428,1428,1428,1428,1428,1435,1440,1445,1450,1460,1465,1470,1475,1480,1485,1490,1495,1500,1505,1510,1515,1510,1505,1500};
char panPensar[SIZE_EMO] = {0,-3,-3,-4,-4,-4,-4,-5,-5,-6,-6,-6,-6,-7,-7,-7,-8,-8,-8,-8,-9,-9,-9,-9,-9,-9,-9,-9,-9,-9,-9,-9,-9,-9,-9,-9,-9,-9,-9,-9,-9,-9,-9,-9,-9,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,3,3,4,4,5,5,6,6,7,7,7,7,7,8,8,8,9,9,9,9,9,9,9,9,8,8,8,8,8,8,8,8,8,8,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,3,-4,-5,-5,-6,-6,-7,-7,-7,-7,-7,-8,-8,-8,-8,-8,-8,-8,-8,-8,-8,-8,-8,-8,-8,-8,-8,-8,-8,-8,-8,-8,-8,-8,-8,-8,-8,-8,-8,-8,-8,-8,-8,-8,-8,-8,-8,-8,-8,-8,-8,-8,-8,-4,-5,-6,-7,-7,-8,-8,-8,-8,-8,8,9,10,10};
char tiltPensar[SIZE_EMO] = {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,3,3,3,4,5,5,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,5,3,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,-3,-5,-5,-6,-6,-6,-7,-7,-7,-7,-7,-8,-8,-9,-9,-9,-9,-9,-9,-9,-8,-8,-8,-7,-7,-6,-5,-4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,7,5,5,5,10,5,5,5,5,5,5,5,5,5,5,5,-5,-5,-5};

//Pensar 2
//int emoPan[SIZE_EMO] = {1500,1502,1504,1506,1508,1510,1512,1514,1517,1520,1523,1526,1529,1532,1536,1540,1544,1548,1552,1556,1560,1564,1568,1572,1576,1580,1584,1588,1592,1596,1600,1604,1608,1612,1616,1620,1624,1628,1632,1636,1640,1644,1648,1652,1656,1660,1664,1668,1672,1676,1680,1684,1688,1693,1697,1701,1705,1709,1713,1717,1721,1725,1729,1733,1737,1741,1745,1749,1753,1757,1761,1765,1769,1773,1777,1781,1785,1789,1793,1797,1801,1805,1809,1813,1817,1821,1825,1829,1833,1837,1841,1845,1849,1853,1855,1852,1848,1844,1840,1836,1832,1827,1822,1817,1812,1807,1802,1796,1790,1784,1778,1772,1766,1760,1754,1748,1742,1736,1730,1724,1718,1712,1706,1700,1694,1688,1682,1676,1670,1664,1658,1652,1647,1647,1647,1647,1647,1647,1647,1647,1647,1647,1647,1647,1647,1647,1647,1647,1647,1647,1647,1647,1647,1647,1647,1647,1647,1647,1647,1647,1647,1647,1647,1647,1647,1647,1647,1647,1647,1647,1647,1647,1647,1647,1647,1647,1647,1647,1647,1647,1647,1647,1647,1647,1647,1647,1647,1647,1647,1647,1647,1647,1647,1647,1647,1647,1647,1643,1639,1635,1631,1627,1622,1617,1612,1607,1601,1595,1589,1583,1577,1571,1564,1557,1550,1543,1536,1529,1522,1515,1508,1501,1494,1487,1480,1473,1466,1459,1452,1445,1441,1441,1441,1441,1441,1441,1441,1441,1441,1441,1441,1441,1441,1441,1441,1441,1441,1441,1441,1441,1441,1441,1441,1441,1441,1441,1441,1441,1441,1441,1441,1441,1441,1441,1441,1441,1441,1441,1441,1441,1441,1441,1441,1441,1441,1441,1441,1441,1441,1441,1441,1441,1444,1448,1452,1456,1460,1464,1468,1472,1476,1480,1484,1488,1492,1496,1500,1505,1510,1515};
//int emoTilt[SIZE_EMO] = {1500,1500,1500,1500,1500,1500,1500,1500,1500,1500,1500,1500,1500,1500,1500,1500,1500,1500,1500,1500,1500,1500,1500,1500,1500,1500,1500,1500,1500,1500,1500,1500,1500,1500,1500,1500,1500,1500,1500,1500,1500,1500,1500,1500,1500,1500,1500,1500,1500,1500,1500,1500,1500,1500,1500,1500,1500,1500,1500,1500,1500,1500,1500,1500,1500,1500,1500,1500,1500,1500,1500,1500,1500,1500,1500,1500,1500,1500,1500,1500,1500,1500,1500,1500,1500,1500,1500,1500,1500,1500,1500,1500,1500,1500,1500,1500,1500,1500,1500,1500,1500,1500,1500,1500,1500,1500,1500,1500,1500,1500,1500,1500,1500,1500,1500,1500,1500,1500,1500,1500,1500,1500,1500,1500,1500,1500,1500,1500,1500,1500,1500,1500,1500,1503,1507,1512,1518,1523,1528,1533,1538,1543,1548,1553,1558,1563,1568,1574,1580,1586,1592,1598,1604,1610,1616,1622,1628,1634,1639,1643,1645,1642,1639,1636,1633,1630,1626,1621,1616,1611,1606,1601,1596,1591,1586,1581,1576,1571,1566,1561,1556,1551,1547,1542,1538,1534,1530,1526,1522,1518,1514,1511,1508,1505,1502,1499,1496,1496,1496,1496,1496,1496,1496,1496,1496,1496,1496,1496,1496,1496,1496,1496,1496,1496,1496,1496,1496,1496,1496,1496,1496,1496,1496,1496,1496,1496,1496,1496,1496,1496,1496,1499,1502,1506,1510,1515,1521,1527,1533,1539,1545,1551,1558,1565,1572,1579,1586,1593,1600,1607,1613,1618,1622,1626,1629,1631,1628,1625,1622,1619,1616,1613,1610,1607,1604,1601,1598,1595,1592,1589,1586,1583,1580,1576,1572,1569,1566,1563,1559,1555,1551,1548,1548,1548,1548,1548,1548,1548,1548,1548,1548,1548,1548,1548,1548,1548,1548,1548,1548,1548};

//char panPensar2[SIZE_EMO] = {0,2,2,2,2,2,2,2,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,5,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,2,-3,-4,-4,-4,-4,-4,-5,-5,-5,-5,-5,-5,-6,-6,-6,-6,-6,-6,-6,-6,-6,-6,-6,-6,-6,-6,-6,-6,-6,-6,-6,-6,-6,-6,-6,-6,-6,-5,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,-4,-4,-4,-4,-4,-5,-5,-5,-5,-6,-6,-6,-6,-6,-6,-7,-7,-7,-7,-7,-7,-7,-7,-7,-7,-7,-7,-7,-7,-7,-7,-7,-7,-4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,3,4,4,4,4,4,4,4,4,4,4,4,4,4,4,5,5,5};
//char tiltPensar2[SIZE_EMO] ={0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,3,4,5,6,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,6,6,5,4,2,-3,-3,-3,-3,-3,-4,-5,-5,-5,-5,-5,-5,-5,-5,-5,-5,-5,-5,-5,-5,-5,-4,-5,-4,-4,-4,-4,-4,-4,-4,-3,-3,-3,-3,-3,-3,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,3,3,4,4,5,6,6,6,6,6,6,7,7,7,7,7,7,7,7,6,5,4,4,3,2,-3,-3,-3,-3,-3,-3,-3,-3,-3,-3,-3,-3,-3,-3,-3,-3,-3,-4,-4,-3,-3,-3,-4,-4,-4,-3,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0};



int valorPanAnt;

void setup()
{

  Serial.begin(9600);
 
  //initialize servos
  panServo.attach(PAN_PIN, PAN_MIN, PAN_MAX);  // attaches/activates the pan servo on pin PAN_PIN and sets lower/upper limits that can be sent to the servo
  tiltServo.attach(TILT_PIN, TILT_MIN, TILT_MAX);  // attaches/activates the tilt servo on pin TILT_PIN and sets lower/upper limits that can be sent to the servo

  //initalize digital pins
  pinMode(PUSHBUTTON_PIN, INPUT);  //set the PUSHBUTTON Pin to an Input
  pinMode(LASER_PIN, OUTPUT);      //set the LASER Pin to an output
 
  //Analog pins do not need to be initialized
 
 
  //write initial servo positions to set the servos to 'home'
  panServo.writeMicroseconds(panValue);  //sets the pan servo position to the default 'home' value
  tiltServo.writeMicroseconds(tiltValue);//sets the tilt servo position to the default 'home' value
 
}


void loop(){

  if(Serial.available()>0){
    ordenMovimiento = Serial.read();
 

  switch(ordenMovimiento){
      case 'T': movimientoTristeza();
      Serial.println("Tristeza");
      //panValue = 600;
      break;
      case 80:
     
      movimientoPensar();
      Serial.println("Pensar");
      break;
      case 'F':
      break;
      case 'I':
      movimientoIzquierda();
      Serial.println("Izq");
      break;
      case 'D':
      movimientoDerecha();
      Serial.println("Der");
      break;
      case 'C':
      movimientoCentro();
      Serial.println("Cen");
      break;
      case '2':
      movimientoPensar2();
      break;
      case '3':
      movimientoIzquierda();
      movimientoCentro();
      movimientoDerecha();
      movimientoCentro();
      break;
      case '4':
      movimientoDerecha();
      movimientoCentro();
      movimientoIzquierda();
      movimientoCentro();
      break;
  }
  }
  /*horizontalValue = analogRead(H_JOY_PIN);
  verticalValue = analogRead(V_JOY_PIN);
  Serial.print("Horizontal: ");
  Serial.println(horizontalValue);
  Serial.print("Vertical: ");
  Serial.println(verticalValue);*/
  //delay(15);
}

void movimientoIzquierda(){
  int valorPan = 1500;
  int valorTilt = 1500;
  int i;
  for(i=valorPan;i<=1800; i+=10){
    panServo.writeMicroseconds(i);
    delay(30);
  }
  valorPanAnt = i;
}

void movimientoDerecha(){
  int valorPan = 1500;
  int valorTilt = 1500;
  int i;
  for(i=valorPan;i>=1200; i-=10){
    panServo.writeMicroseconds(i);
    delay(30);
  }
  valorPanAnt = i;
}

void movimientoCentro(){
 
 if(valorPanAnt > 1500){
  for(int i=valorPanAnt;i>=1500; i-=10){
    panServo.writeMicroseconds(i);
    delay(30);
  }
 }
 else
  if(valorPanAnt < 1500){
    for(int i=valorPanAnt;i<=1500; i+=10){
      panServo.writeMicroseconds(i);
      delay(30);
    }  
  }
}

void movimientoTristeza(){
  int valorPan = 1500;
  int valorTilt = 1500;
  for(int i=0;i<SIZE_EMO;i++){
    valorPan+=panTristeza[i];
    valorTilt+=tiltTristeza[i];
    panServo.writeMicroseconds(valorPan);   // sets the servo position based on the latest panServo value
    tiltServo.writeMicroseconds(valorTilt); // sets the servo position based on the latest tiltServo value
    delay(25);
  }
 /*int valor, anterior = 1500;
 
 for(int i=0;i<SIZE_EMO;i++){
      valor = panTristeza[i]-anterior;
      Serial.print(valor);
      Serial.print(",");
      anterior = panTristeza[i];
    }
  Serial.println("}");
  valor = 1500;
  for(int i=0;i<SIZE_EMO;i++){
    valor = tiltTristeza[i]-anterior;
    Serial.print(valor);
    Serial.print(",");
    anterior = tiltTristeza[i];
  }
  Serial.println("}");*/
 
}


void movimientoPensar(){
  int valorPan = 1500;
  int valorTilt = 1500;
  for(int i=0;i<SIZE_EMO;i++){
    valorPan+=panPensar[i];
    valorTilt+=tiltPensar[i];
    panServo.writeMicroseconds(valorPan);   // sets the servo position based on the latest panServo value
    tiltServo.writeMicroseconds(valorTilt); // sets the servo position based on the latest tiltServo value
    delay(20);
  }
  valorPanAnt = valorPan;

 /*int valor, anterior = 1500;
 
 for(int i=0;i<SIZE_EMO;i++){
      valor = emoPan[i]-anterior;
      Serial.print(valor);
      Serial.print(",");
      anterior = emoPan[i];
    }
  Serial.println("}");
  valor = 1500;
  for(int i=0;i<SIZE_EMO;i++){
    valor = emoTilt[i]-anterior;
    Serial.print(valor);
    Serial.print(",");
    anterior = emoTilt[i];
  }
  Serial.println("}");
  */
}

void movimientoPensar2(){
  int valorPan = 1500;
  int valorTilt = 1500;
  for(int i=0;i<SIZE_EMO;i++){
    //valorPan+=panPensar2[i];
    //valorTilt+=tiltPensar2[i];
    panServo.writeMicroseconds(valorPan);   // sets the servo position based on the latest panServo value
    tiltServo.writeMicroseconds(valorTilt); // sets the servo position based on the latest tiltServo value
    delay(20);
  }
  valorPanAnt = valorPan;

}
